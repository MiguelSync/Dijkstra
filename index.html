<!DOCTYPE html>
<html lang="ptBR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fernandius</title>
    <link rel="stylesheet" href="resources/css/style.css">
    <script src="resources/js/Aresta.js"></script>
    <script src="resources/js/Cidade.js"></script>
    <script src="resources/js/Grafo.js"></script>
    <script src="resources/js/Dijkstra.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script> document.body.classList.remove('swal2-height-auto'); </script>

</head>
<body onload="onLoadDijkstra()">
    <div class="inputCalcula">
        <div class="input">
            <div class="inicio">
                <h3 class="titleDestino">Inicio Destino</h3>
                <select name="cidadeInicio" id="cidadeInicio" class="inputs">
                    <option value="default">Selecione...</option>
                </select>
            </div>
            
            <div class="seta">
                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-arrow-right-circle-fill" viewBox="0 0 16 16">
                    <path class="img" d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0M4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5z"/>
                </svg>
            </div>

            <div class="fim">
                <h3 class="titleDestino">Fim Destino</h3>
                <select name="cidadeFim" id="cidadeFim" class="inputs">
                    <option value="default">Selecione...</option>
                </select>
            </div>

        </div>
            
            <button class="btn btn-primary button" onclick="calculaDistanciaMinima()">Calcule Aqui</button>
    </div>

    <div id="resultado" class="mt-5 text-center">
        <div class="vertices-resultado" id="vertices-resultado"></div>
    </div>

</body>

<!-- Área onde o grafo será desenhado -->

<script src="https://d3js.org/d3.v7.min.js"></script>
<script>
function exibirResultado(caminho, totalCusto) {
    // Limpar resultados anteriores
    const container = d3.select("#resultado");
    container.html("");

    // Título
    container.append("h3")
        .text("Caminho Mínimo Encontrado")
        .style("margin-bottom", "20px");

    // Definir dimensões do SVG
    const largura = 800, altura = 300;
    const svg = container.append("svg")
        .attr("width", largura)
        .attr("height", altura)
        .style("background", "#f9f9f9")
        .style("border-radius", "12px")
        .style("box-shadow", "0 2px 6px rgba(0,0,0,0.1)");

    // Escala para posicionar os nós de forma linear
    const xScale = d3.scalePoint()
        .domain(caminho.map((d, i) => i))
        .range([100, largura - 100]);

    const y = altura / 2;

    // Desenhar arestas
    for (let i = 0; i < caminho.length - 1; i++) {
        const x1 = xScale(i);
        const x2 = xScale(i + 1);

        // Linha da aresta
        svg.append("line")
            .attr("x1", x1)
            .attr("y1", y)
            .attr("x2", x2)
            .attr("y2", y)
            .attr("stroke", "#007bff")
            .attr("stroke-width", 2);

        // Texto com número da aresta + custo
        svg.append("text")
            .attr("x", (x1 + x2) / 2)
            .attr("y", y - 10)
            .attr("text-anchor", "middle")
            .attr("fill", "#333")
            .style("font-size", "12px")
            .text(`${caminho[i].aresta} | Custo ${caminho[i].custo}`);
    }

    // Desenhar nós (cidades)
    caminho.forEach((cidade, i) => {
        const x = xScale(i);

        svg.append("circle")
            .attr("cx", x)
            .attr("cy", y)
            .attr("r", 25)
            .attr("fill", "#fff")
            .attr("stroke", "#007bff")
            .attr("stroke-width", 2);

        svg.append("text")
            .attr("x", x)
            .attr("y", y + 5)
            .attr("text-anchor", "middle")
            .style("font-size", "14px")
            .style("font-weight", "bold")
            .text(cidade.nome);
    });

    // Resumo final
    container.append("div")
        .style("margin-top", "20px")
        .html(`
            <p><strong>Custo Total:</strong> ${totalCusto}</p>
            <p><strong>Cidades Percorridas:</strong> ${caminho.length}</p>
        `);
}
</script>

</html>